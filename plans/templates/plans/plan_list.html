{% extends "base.html" %}

{% block content %}
<h1>{{ selected_level|title if selected_level else "All" }} Plans</h1>

{% if plans %}
    <ul>
    {% for plan in plans %}
        <li>
            <strong>Plan:</strong> {{ plan }} <br>
            <strong>User:</strong> {{ plan.user.username }} <br>
            <strong>Status:</strong> {{ plan.status }} <br>
            
            <!-- Strategic Goals -->
            {% if plan.strategicgoal_set.exists %}
                <strong>Goals:</strong>
                <ul>
                    {% for goal in plan.strategicgoal_set.all %}
                        <li>{{ goal.title }}: {{ goal.description }}</li>
                    {% endfor %}
                </ul>
            {% endif %}

            <!-- KPIs -->
            {% if plan.kpi_set.exists %}
                <strong>KPIs:</strong>
                <ul>
                    {% for kpi in plan.kpi_set.all %}
                        <li>{{ kpi.name }} - Baseline: {{ kpi.baseline }}, Target: {{ kpi.target }}, Accountable: {{ kpi.accountable_person }}, Budget: {{ kpi.budget }}</li>
                    {% endfor %}
                </ul>
            {% endif %}

            <!-- Activities -->
            {% if plan.activity_set.exists %}
                <strong>Activities:</strong>
                <ul>
                    {% for activity in plan.activity_set.all %}
                        <li>{{ activity.major_activity }} - {{ activity.detail_activity }} (Responsible: {{ activity.responsible_person }}, Status: {{ activity.status }}, Budget: {{ activity.budget }})</li>
                    {% endfor %}
                </ul>
            {% endif %}

        </li>
        <hr>
    {% endfor %}
    </ul>
{% else %}
    <p>No plans available.</p>
{% endif %}

{% endblock %}
